{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/allodyaq/Tugas-3-KosHub-18223054/koshub/app/notifications/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useAuth } from '../lib/AuthContext';\nimport { notificationApi } from '../lib/api';\nimport type { Notification } from '../types';\nimport {\n    Bell,\n    Check,\n    CheckCheck,\n    Trash2,\n    Shirt,\n    UtensilsCrossed,\n    Building2,\n    Info,\n    AlertCircle,\n    CheckCircle,\n    XCircle,\n    Clock\n} from 'lucide-react';\nimport { format, formatDistanceToNow } from 'date-fns';\nimport Link from 'next/link';\n\nexport default function NotificationsPage() {\n    const { isAuthenticated } = useAuth();\n    const router = useRouter();\n    const [notifications, setNotifications] = useState<Notification[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [filter, setFilter] = useState<'all' | 'unread' | 'read'>('all');\n    const [actionLoading, setActionLoading] = useState<number | null>(null);\n\n    useEffect(() => {\n        if (!isAuthenticated) {\n            router.push('/auth/login');\n            return;\n        }\n        fetchNotifications();\n    }, [isAuthenticated, router, filter]);\n\n    const fetchNotifications = async () => {\n        try {\n            setLoading(true);\n            let data: Notification[];\n\n            if (filter === 'all') {\n                data = await notificationApi.getAll();\n            } else {\n                data = await notificationApi.getAll(filter === 'unread' ? false : true);\n            }\n\n            setNotifications(Array.isArray(data) ? data : []);\n        } catch (error) {\n            console.error('Failed to fetch notifications:', error);\n            setNotifications([]);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleMarkAsRead = async (id: number) => {\n        try {\n            setActionLoading(id);\n            await notificationApi.markAsRead(id);\n            setNotifications(prev =>\n                prev.map(n => n.id === id ? { ...n, is_read: true } : n)\n            );\n        } catch (error) {\n            console.error('Failed to mark as read:', error);\n        } finally {\n            setActionLoading(null);\n        }\n    };\n\n    const handleMarkAllAsRead = async () => {\n        try {\n            setActionLoading(-1);\n            await notificationApi.markAllAsRead();\n            setNotifications(prev => prev.map(n => ({ ...n, is_read: true })));\n        } catch (error) {\n            console.error('Failed to mark all as read:', error);\n        } finally {\n            setActionLoading(null);\n        }\n    };\n\n    const getTypeIcon = (type: Notification['type']) => {\n        switch (type) {\n            case 'laundry':\n                return <Shirt size={20} className=\"text-primary-600\" />;\n            case 'catering':\n                return <UtensilsCrossed size={20} className=\"text-orange-600\" />;\n            case 'booking':\n                return <Building2 size={20} className=\"text-blue-600\" />;\n            default:\n                return <Info size={20} className=\"text-gray-600\" />;\n        }\n    };\n\n    const getSeverityIcon = (severity: Notification['severity']) => {\n        switch (severity) {\n            case 'success':\n                return <CheckCircle size={16} className=\"text-green-500\" />;\n            case 'warning':\n                return <AlertCircle size={16} className=\"text-yellow-500\" />;\n            case 'error':\n                return <XCircle size={16} className=\"text-red-500\" />;\n            default:\n                return <Info size={16} className=\"text-blue-500\" />;\n        }\n    };\n\n    const getSeverityBg = (severity: Notification['severity'], isRead: boolean) => {\n        if (isRead) return 'bg-gray-50';\n        switch (severity) {\n            case 'success':\n                return 'bg-green-50 border-l-4 border-green-500';\n            case 'warning':\n                return 'bg-yellow-50 border-l-4 border-yellow-500';\n            case 'error':\n                return 'bg-red-50 border-l-4 border-red-500';\n            default:\n                return 'bg-blue-50 border-l-4 border-blue-500';\n        }\n    };\n\n    const getNotificationLink = (notification: Notification): string | null => {\n        if (!notification.reference_id) return null;\n\n        switch (notification.type) {\n            case 'laundry':\n                return '/dashboard';\n            case 'catering':\n                return '/dashboard';\n            case 'booking':\n                return '/dashboard';\n            default:\n                return null;\n        }\n    };\n\n    const unreadCount = notifications.filter(n => !n.is_read).length;\n\n    if (!isAuthenticated) {\n        return null;\n    }\n\n    return (\n        <div className=\"min-h-screen bg-gray-50 py-12\">\n            <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8\">\n                {/* Header */}\n                <div className=\"bg-white rounded-2xl shadow-lg p-6 mb-6\">\n                    <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-4\">\n                            <div className=\"w-14 h-14 bg-primary-100 rounded-full flex items-center justify-center\">\n                                <Bell className=\"text-primary-600\" size={28} />\n                            </div>\n                            <div>\n                                <h1 className=\"text-2xl font-bold text-gray-900\">Notifications</h1>\n                                <p className=\"text-gray-600\">\n                                    {unreadCount > 0\n                                        ? `You have ${unreadCount} unread notification${unreadCount > 1 ? 's' : ''}`\n                                        : 'All caught up!'\n                                    }\n                                </p>\n                            </div>\n                        </div>\n                        {unreadCount > 0 && (\n                            <button\n                                onClick={handleMarkAllAsRead}\n                                disabled={actionLoading === -1}\n                                className=\"flex items-center gap-2 px-4 py-2 text-primary-600 hover:bg-primary-50 rounded-lg transition-colors disabled:opacity-50\"\n                            >\n                                <CheckCheck size={18} />\n                                <span className=\"hidden sm:inline\">Mark all as read</span>\n                            </button>\n                        )}\n                    </div>\n                </div>\n\n                {/* Filter Tabs */}\n                <div className=\"bg-white rounded-xl shadow p-2 mb-6 flex gap-2\">\n                    {(['all', 'unread', 'read'] as const).map((tab) => (\n                        <button\n                            key={tab}\n                            onClick={() => setFilter(tab)}\n                            className={`flex-1 py-2 px-4 rounded-lg font-medium transition-colors ${filter === tab\n                                    ? 'bg-primary-600 text-white'\n                                    : 'text-gray-600 hover:bg-gray-100'\n                                }`}\n                        >\n                            {tab.charAt(0).toUpperCase() + tab.slice(1)}\n                            {tab === 'unread' && unreadCount > 0 && (\n                                <span className=\"ml-2 bg-white/20 px-2 py-0.5 rounded-full text-sm\">\n                                    {unreadCount}\n                                </span>\n                            )}\n                        </button>\n                    ))}\n                </div>\n\n                {/* Notifications List */}\n                <div className=\"space-y-3\">\n                    {loading ? (\n                        <div className=\"bg-white rounded-xl shadow-lg p-12 text-center\">\n                            <div className=\"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\n                            <p className=\"text-gray-600\">Loading notifications...</p>\n                        </div>\n                    ) : notifications.length === 0 ? (\n                        <div className=\"bg-white rounded-xl shadow-lg p-12 text-center\">\n                            <Bell className=\"mx-auto text-gray-300 mb-4\" size={64} />\n                            <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\n                                {filter === 'all' ? 'No notifications yet' : `No ${filter} notifications`}\n                            </h3>\n                            <p className=\"text-gray-600\">\n                                {filter === 'all'\n                                    ? \"You'll see notifications about your orders and services here\"\n                                    : filter === 'unread'\n                                        ? \"You've read all your notifications\"\n                                        : \"No read notifications to show\"\n                                }\n                            </p>\n                        </div>\n                    ) : (\n                        notifications.map((notification) => {\n                            const link = getNotificationLink(notification);\n                            const NotificationWrapper = link ? Link : 'div';\n\n                            return (\n                                <div\n                                    key={notification.id}\n                                    className={`bg-white rounded-xl shadow hover:shadow-md transition-all overflow-hidden ${!notification.is_read ? 'ring-2 ring-primary-200' : ''\n                                        }`}\n                                >\n                                    <div className={`p-4 ${getSeverityBg(notification.severity, notification.is_read)}`}>\n                                        <div className=\"flex items-start gap-4\">\n                                            {/* Type Icon */}\n                                            <div className={`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ${notification.is_read ? 'bg-gray-100' : 'bg-white shadow'\n                                                }`}>\n                                                {getTypeIcon(notification.type)}\n                                            </div>\n\n                                            {/* Content */}\n                                            <div className=\"flex-1 min-w-0\">\n                                                <div className=\"flex items-start justify-between gap-2\">\n                                                    <div>\n                                                        <div className=\"flex items-center gap-2 mb-1\">\n                                                            {getSeverityIcon(notification.severity)}\n                                                            <h3 className={`font-semibold ${notification.is_read ? 'text-gray-700' : 'text-gray-900'\n                                                                }`}>\n                                                                {notification.title}\n                                                            </h3>\n                                                        </div>\n                                                        <p className={`text-sm ${notification.is_read ? 'text-gray-500' : 'text-gray-700'\n                                                            }`}>\n                                                            {notification.message}\n                                                        </p>\n                                                    </div>\n\n                                                    {/* Unread indicator */}\n                                                    {!notification.is_read && (\n                                                        <div className=\"w-3 h-3 bg-primary-500 rounded-full flex-shrink-0 mt-1\"></div>\n                                                    )}\n                                                </div>\n\n                                                {/* Footer */}\n                                                <div className=\"flex items-center justify-between mt-3\">\n                                                    <div className=\"flex items-center gap-2 text-xs text-gray-500\">\n                                                        <Clock size={12} />\n                                                        <span>\n                                                            {formatDistanceToNow(new Date(notification.created_at), { addSuffix: true })}\n                                                        </span>\n                                                        <span className=\"text-gray-300\">•</span>\n                                                        <span className=\"capitalize px-2 py-0.5 bg-gray-100 rounded\">\n                                                            {notification.type}\n                                                        </span>\n                                                    </div>\n\n                                                    {/* Actions */}\n                                                    <div className=\"flex items-center gap-2\">\n                                                        {!notification.is_read && (\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.preventDefault();\n                                                                    e.stopPropagation();\n                                                                    handleMarkAsRead(notification.id);\n                                                                }}\n                                                                disabled={actionLoading === notification.id}\n                                                                className=\"text-sm text-primary-600 hover:text-primary-700 flex items-center gap-1 disabled:opacity-50\"\n                                                            >\n                                                                <Check size={14} />\n                                                                Mark as read\n                                                            </button>\n                                                        )}\n                                                        {link && (\n                                                            <Link\n                                                                href={link}\n                                                                className=\"text-sm text-gray-600 hover:text-gray-800 flex items-center gap-1\"\n                                                            >\n                                                                View Details →\n                                                            </Link>\n                                                        )}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            );\n                        })\n                    )}\n                </div>\n\n                {/* Back to Dashboard */}\n                <div className=\"mt-8 text-center\">\n                    <Link\n                        href=\"/dashboard\"\n                        className=\"text-primary-600 hover:text-primary-700 font-medium\"\n                    >\n                        ← Back to Dashboard\n                    </Link>\n                </div>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}}]
}